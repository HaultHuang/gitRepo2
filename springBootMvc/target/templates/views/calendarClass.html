<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<div th:fragment="content">

    <script type="text/javascript">
        $(function () {
            var table = $('#calendarClassTable').DataTable({
                "columns": [
                    {
                        "class":          "details-control",
                        "orderable":      false,
                        "data":           null,
                        "defaultContent": ""
                    },
                    { "data": "id" },
                    { "data": "code" },
                    { "data": "name" }
                ],
                "columnDefs": [
                    {
                        "targets": [ 1 ],
                        "visible": false,
                    }
                ],
                "order": [[1, 'desc']]});

            $('#calendarClassTable tbody').on( 'click', 'tr', function () {
                $(this).toggleClass('selected');
            } );

            $('#addRow').on( 'click', function () {
                table.row.add( ['',''] ).draw( false );
            } );

            // Array to track the ids of the details displayed rows
            var detailRows = [];

            $('#calendarClassTable tbody').on( 'click', 'tr td.details-control', function () {
                var tr = $(this).closest('tr');
                var row = table.row( tr );
                var idx = $.inArray( tr.attr('id'), detailRows );

                if ( row.child.isShown() ) {
                    tr.removeClass( 'details' );
                    row.child.hide();

                    // Remove from the 'open' array
                    detailRows.splice( idx, 1 );
                }
                else {
                    tr.addClass( 'details' );
                    row.child( format( row.data() ) ).show();

                    // Add to the 'open' array
                    if ( idx === -1 ) {
                        detailRows.push( tr.attr('id') );
                    }
                }
            } );

            // On each draw, loop over the `detailRows` array and show any child rows
            table.on( 'draw', function () {
                $.each( detailRows, function ( i, id ) {
                    $('#'+id+' td.details-control').trigger( 'click' );
                } );
            } );
        });

        function format ( d ) {
            return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">'+
                    '<tr>'+
                    '<td>Id:</td>'+
                    '<td>'+d.id+'</td>'+
                    '</tr>'+
                    '<tr>'+
                    '<td>Code:</td>'+
                    '<td>'+d.code+'</td>'+
                    '</tr>'+
                    '<tr>'+
                    '<td>Name:</td>'+
                    '<td>'+d.name+'</td>'+
                    '</tr>'+
                    '<tr>'+
                    '<td>Extra info:</td>'+
                    '<td>And any further details here (images etc)...</td>'+
                    '</tr>'+
                    '</table>';
        }

    </script>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-10">
                <table id="calendarClassTable" class="display" cellspacing="0">
                    <thead>
                    <tr>
                        <th class="details-control"/>
                        <th>Id</th>
                        <th>Code</th>
                        <th>Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="calendarClass:${calendarClasses}">
                        <td class="details-control"/>
                        <td th:text="${calendarClass.id}"/>
                        <td th:text="${calendarClass.code}"/>
                        <td th:text="${calendarClass.name}"/>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-2">
                <button id="addRow" class="btn btn-primary"><span th:text="#{button.add.row}"/></button>
            </div>
        </div>
    </div>
</div>

</html>